;--------------------------------------------------------------------------
; State 0
;--------------------------------------------------------------------------
[logic@val_prisoner]
active          = walker@wander
on_death        = death
combat_ignore   = combat_ignore

[death]
on_info         = %+val_prisoner_dead%

;--------------------------------------------------------------------------
; основной диалог
;--------------------------------------------------------------------------
[meet@main]
meet_dialog     = val_prisoner_hello
meet_state      = 5|wait
meet_state_wpn  = 5|wait
victim          = 7|actor
victim_wpn      = 7|actor
use             = true
use_wpn         = true

[meet@near_door]
meet_dialog     = val_prisoner_hello
meet_state      = 15|hello@val_prisoner_captive_come_here|7|wait
meet_state_wpn  = 15|hello@val_prisoner_captive_come_here|7|wait
victim          = 20|actor
victim_wpn      = 20|actor
use             = true
use_wpn         = true

[meet@ignore_abuse]
use             = false
use_wpn         = false
abuse           = false

;--------------------------------------------------------------------------
; основной денжер
;--------------------------------------------------------------------------
[danger@small]
ignore_types          = corpse
ignore_distance_sound = 15

;--------------------------------------------------------------------------
; режим ожидания
;--------------------------------------------------------------------------
[walker@wander]
path_walk                           = captive_cage_walk
path_look                           = captive_cage_look
on_info                             = {+val_prisoner_sit} walker@sit
on_actor_in_zone                    = val_prisoner_window_zone | walker@near_window
on_actor_in_zone2                   = val_prisoner_near_door_zone | walker@near_door
on_actor_dist_ge                    = 30 | walker@actor_far
meet                                = meet@ignore_abuse
combat_ignore_cond                  = always
combat_ignore_keep_when_attacked    = true

;--------------------------------------------------------------------------
; игрок отошел дальше 30 метров
;--------------------------------------------------------------------------
[walker@actor_far]
path_walk                           = captive_sit_walk
path_look                           = captive_sit_look
on_actor_dist_le                    = 30 | walker@wander
meet                                = meet@ignore_abuse
combat_ignore_cond                  = always
combat_ignore_keep_when_attacked    = true

;--------------------------------------------------------------------------
; игрок стоит возле окна. диалог с просьбой о помощи
;--------------------------------------------------------------------------
[walker@near_window]
path_walk                           = captive_window_walk
path_look                           = captive_window_look
on_info                             = {+val_prisoner_sit} walker@sit
on_actor_not_in_zone                = val_prisoner_window_zone | walker@wander
on_actor_in_zone                    = val_prisoner_near_door_zone | walker@near_door
meet                                = meet@main
combat_ignore_cond                  = always
combat_ignore_keep_when_attacked    = true

;--------------------------------------------------------------------------
; сидим, ждем когда игрок освободит нас
;--------------------------------------------------------------------------
[walker@sit]
path_walk                           = captive_sit_walk
path_look                           = captive_sit_look
on_actor_in_zone                    = val_prisoner_near_door_zone | walker@near_door
meet                                = meet@ignore_abuse
combat_ignore_cond                  = always
combat_ignore_keep_when_attacked    = true

;--------------------------------------------------------------------------
; игрок возле двери
;--------------------------------------------------------------------------
[walker@near_door]
path_walk                           = captive_near_door_walk
path_look                           = captive_near_door_look
on_info                             = {+val_prisoner_door_unlocked} walker@final
on_actor_not_in_zone                = val_prisoner_near_door_zone| {+val_prisoner_sit} walker@sit, walker@wander
meet                                = meet@near_door
combat_ignore_cond                  = always
combat_ignore_keep_when_attacked    = true
;--------------------------------------------------------------------------
; открыли дверь, остаётся стоять на месте
;--------------------------------------------------------------------------
[walker@final]
path_walk                           = captive_near_door_walk
path_look                           = captive_near_door_look
meet                                = meet@near_door
combat_ignore_cond                  = always
combat_ignore_keep_when_attacked    = true


